# ChatQA: GPT-4ë¥¼ ë„˜ì–´ì„  ì˜¤í”ˆì†ŒìŠ¤ RAG ëª¨ë¸ì˜ íƒ„ìƒ

> ì´ ê¸€ì€ NVIDIAì—ì„œ ë°œí‘œí•œ ë…¼ë¬¸ "ChatQA: Surpassing GPT-4 on Conversational QA and RAG" (NeurIPS 2024)ì˜ í•µì‹¬ ë‚´ìš©ì„ ì‰½ê²Œ í’€ì–´ ì„¤ëª…í•©ë‹ˆë‹¤.

---

## ğŸ¯ í•œ ì¤„ ìš”ì•½

**OpenAI GPTì˜ í•©ì„± ë°ì´í„° ì—†ì´, Llama2 ê¸°ë°˜ìœ¼ë¡œ GPT-4ë¥¼ ëŠ¥ê°€í•˜ëŠ” ëŒ€í™”í˜• QA ë° RAG ëª¨ë¸ì„ ë§Œë“  ë°©ë²•ë¡ **

---

## ğŸ“Œ ë“¤ì–´ê°€ë©°: ì™œ ChatQAê°€ ì¤‘ìš”í•œê°€?

ChatGPTì˜ ë“±ì¥ ì´í›„, "ë¬¸ì„œë¥¼ ì½ê³  ì§ˆë¬¸ì— ë‹µí•˜ëŠ”" ëŒ€í™”í˜• QA ì‹œìŠ¤í…œì— ëŒ€í•œ ìˆ˜ìš”ê°€ í­ë°œì ìœ¼ë¡œ ì¦ê°€í–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ê¸°ì¡´ RAG ì‹œìŠ¤í…œì˜ ë”œë ˆë§ˆ                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  ğŸ”’ GPT-4 ì‚¬ìš©?                                         â”‚
â”‚     â†’ ì„±ëŠ¥ì€ ì¢‹ì§€ë§Œ, API ë¹„ìš© + ë°ì´í„° í”„ë¼ì´ë²„ì‹œ ìš°ë ¤   â”‚
â”‚                                                         â”‚
â”‚  ğŸ”“ ì˜¤í”ˆì†ŒìŠ¤ ëª¨ë¸ ì‚¬ìš©?                                  â”‚
â”‚     â†’ ë¹„ìš©ì€ ì ˆê°ë˜ì§€ë§Œ, ì„±ëŠ¥ì´ GPT-4ì— í•œì°¸ ëª» ë¯¸ì¹¨     â”‚
â”‚                                                         â”‚
â”‚  ğŸ’¡ ChatQAì˜ ì§ˆë¬¸:                                      â”‚
â”‚     "ì˜¤í”ˆì†ŒìŠ¤ ëª¨ë¸ë¡œ GPT-4 ìˆ˜ì¤€ì˜ ì„±ëŠ¥ì„ ë‚¼ ìˆ˜ ìˆì„ê¹Œ?"  â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

NVIDIA ì—°êµ¬íŒ€ì€ ì´ ì§ˆë¬¸ì— **"Yes"**ë¼ê³  ë‹µí–ˆìŠµë‹ˆë‹¤.

---

## ğŸ” í•µì‹¬ ë¬¸ì œ: Conversational QAê°€ ì–´ë ¤ìš´ ì´ìœ 

### ì¼ë°˜ QA vs ëŒ€í™”í˜• QA

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ì¼ë°˜ QA (Single-turn)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  ì‚¬ìš©ì: "NVIDIAì˜ 2024ë…„ 4ë¶„ê¸° ë§¤ì¶œì€ ì–¼ë§ˆì¸ê°€ìš”?"      â”‚
â”‚                                                         â”‚
â”‚  â†’ ì§ˆë¬¸ í•˜ë‚˜ì— ë‹µë³€ í•˜ë‚˜                                â”‚
â”‚  â†’ ì§ˆë¬¸ë§Œìœ¼ë¡œ ê²€ìƒ‰ ê°€ëŠ¥                                 â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ëŒ€í™”í˜• QA (Multi-turn)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  ì‚¬ìš©ì: "NVIDIAì˜ 2024ë…„ 4ë¶„ê¸° ë§¤ì¶œì€ ì–¼ë§ˆì¸ê°€ìš”?"      â”‚
â”‚  AI: "221ì–µ ë‹¬ëŸ¬ì…ë‹ˆë‹¤."                                â”‚
â”‚                                                         â”‚
â”‚  ì‚¬ìš©ì: "ì „ë¶„ê¸° ëŒ€ë¹„ ì–¼ë§ˆë‚˜ ì¦ê°€í–ˆì–´?"  â† ë¬¸ì œ!        â”‚
â”‚                                                         â”‚
â”‚  â†’ "ì „ë¶„ê¸°", "ì–¼ë§ˆë‚˜ ì¦ê°€" = ì´ì „ ëŒ€í™” ë§¥ë½ í•„ìš”         â”‚
â”‚  â†’ ì´ ì§ˆë¬¸ë§Œìœ¼ë¡œëŠ” ê²€ìƒ‰ ë¶ˆê°€ëŠ¥                          â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ëŒ€í™”í˜• QAì˜ ë‘ ê°€ì§€ í•µì‹¬ ë„ì „

| ë„ì „ ê³¼ì œ | ì„¤ëª… | ì˜ˆì‹œ |
|----------|------|------|
| **Retrieval ë¬¸ì œ** | í›„ì† ì§ˆë¬¸ì— ëŒ€ëª…ì‚¬, ìƒëµ í‘œí˜„ í¬í•¨ | "ê·¸ê±´ ì–¸ì œ ë°œí‘œëì–´?" |
| **Generation ë¬¸ì œ** | ê²€ìƒ‰ëœ ë¬¸ì„œë¥¼ ì˜ ì´í•´í•˜ê³  ë‹µë³€ ìƒì„± | ê¸´ ë¬¸ì„œ, í…Œì´ë¸”, ê³„ì‚° í•„ìš” |

---

## ğŸ’¡ ChatQAì˜ í•µì‹¬ ì†”ë£¨ì…˜

ChatQAëŠ” **ë‘ ê°€ì§€ í•µì‹¬ í˜ì‹ **ìœ¼ë¡œ ì´ ë¬¸ì œë¥¼ í•´ê²°í•©ë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ChatQA í•µì‹¬ êµ¬ì„± ìš”ì†Œ                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  1ï¸âƒ£ Two-Stage Instruction Tuning                       â”‚
â”‚     â””â”€â†’ Generation ì„±ëŠ¥ í–¥ìƒ                            â”‚
â”‚                                                         â”‚
â”‚  2ï¸âƒ£ Fine-tuned Dense Retriever                         â”‚
â”‚     â””â”€â†’ Retrieval ì„±ëŠ¥ í–¥ìƒ                             â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ í•µì‹¬ ê¸°ìˆ  1: Two-Stage Instruction Tuning

### ì™œ "Two-Stage"ì¸ê°€?

ê¸°ì¡´ ë°©ì‹ì€ í•œ ë²ˆì˜ instruction tuningìœ¼ë¡œ ëª¨ë“  ê²ƒì„ í•´ê²°í•˜ë ¤ í–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ChatQA ì—°êµ¬íŒ€ì€ **ë‹¨ê³„ë¥¼ ë¶„ë¦¬**í•˜ëŠ” ê²ƒì´ ë” íš¨ê³¼ì ì„ì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Two-Stage Instruction Tuning êµ¬ì¡°              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              Pre-trained LLM                     â”‚   â”‚
â”‚  â”‚           (Llama2-7B/13B/70B)                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                        â”‚                                â”‚
â”‚                        â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚         Stage 1: Supervised Fine-Tuning         â”‚   â”‚
â”‚  â”‚                                                  â”‚   â”‚
â”‚  â”‚  ëª©í‘œ: ì¼ë°˜ì ì¸ Instruction Following ëŠ¥ë ¥ ìŠµë“  â”‚   â”‚
â”‚  â”‚                                                  â”‚   â”‚
â”‚  â”‚  ë°ì´í„°: 128K SFT ìƒ˜í”Œ                          â”‚   â”‚
â”‚  â”‚  - Soda, ELI5, FLAN ë“± ë‹¤ì–‘í•œ ë°ì´í„°ì…‹          â”‚   â”‚
â”‚  â”‚  - System / User / Assistant í˜•ì‹               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                        â”‚                                â”‚
â”‚                        â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚    Stage 2: Context-Enhanced Instruction Tuning â”‚   â”‚
â”‚  â”‚                                                  â”‚   â”‚
â”‚  â”‚  ëª©í‘œ: Context í™œìš© ë° RAG ëŠ¥ë ¥ ê°•í™”             â”‚   â”‚
â”‚  â”‚                                                  â”‚   â”‚
â”‚  â”‚  ë°ì´í„°:                                         â”‚   â”‚
â”‚  â”‚  - HumanAnnotatedConvQA (ìƒˆë¡œ êµ¬ì¶•!)            â”‚   â”‚
â”‚  â”‚  - Single-turn QA (DROP, NarrativeQA ë“±)        â”‚   â”‚
â”‚  â”‚  - Stage 1 ë°ì´í„° ì¬í™œìš©                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                        â”‚                                â”‚
â”‚                        â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚               ChatQA Model                       â”‚   â”‚
â”‚  â”‚        (GPT-4 ìˆ˜ì¤€ì˜ Conversational QA)         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Stage 1: Supervised Fine-Tuning (SFT)

ì²« ë²ˆì§¸ ë‹¨ê³„ì—ì„œëŠ” ëª¨ë¸ì´ **ëŒ€í™”ì˜ ê¸°ë³¸ í˜•ì‹**ì„ ìµíˆë„ë¡ í•©ë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Stage 1 SFT ë°ì´í„° ì˜ˆì‹œ                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  System: "ë‹¹ì‹ ì€ ë„ì›€ì´ ë˜ëŠ” AI ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤."       â”‚
â”‚                                                         â”‚
â”‚  User: "íŒŒì´ì¬ì—ì„œ ë¦¬ìŠ¤íŠ¸ë¥¼ ì •ë ¬í•˜ëŠ” ë°©ë²•ì„ ì•Œë ¤ì¤˜"      â”‚
â”‚                                                         â”‚
â”‚  Assistant: "íŒŒì´ì¬ì—ì„œ ë¦¬ìŠ¤íŠ¸ë¥¼ ì •ë ¬í•˜ëŠ” ë°©ë²•ì€         â”‚
â”‚  í¬ê²Œ ë‘ ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤. sort() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜     â”‚
â”‚  sorted() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤..."                 â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Stage 1 ì´í›„ ëª¨ë¸ì˜ ìƒíƒœ:**
- âœ… ëŒ€í™” í˜•ì‹ ì´í•´
- âœ… ì§€ì‹œì‚¬í•­ ë”°ë¥´ê¸°
- âŒ ì£¼ì–´ì§„ ë¬¸ì„œ/ì»¨í…ìŠ¤íŠ¸ í™œìš© ëŠ¥ë ¥ ë¶€ì¡±

### Stage 2: Context-Enhanced Instruction Tuning

ë‘ ë²ˆì§¸ ë‹¨ê³„ì—ì„œëŠ” **ë¬¸ì„œë¥¼ ì½ê³  ë‹µë³€í•˜ëŠ” ëŠ¥ë ¥**ì„ ì§‘ì¤‘ì ìœ¼ë¡œ í›ˆë ¨í•©ë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Stage 2 Context-Enhanced ë°ì´í„° ì˜ˆì‹œ          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  System: "ì£¼ì–´ì§„ ë¬¸ì„œë¥¼ ë°”íƒ•ìœ¼ë¡œ ì§ˆë¬¸ì— ë‹µí•˜ì„¸ìš”."       â”‚
â”‚                                                         â”‚
â”‚  Context: """                                           â”‚
â”‚  NVIDIAëŠ” 2024ë…„ 1ì›” 28ì¼ ë§ˆê°ëœ 4ë¶„ê¸° ì‹¤ì ì„ ë°œí‘œí–ˆë‹¤.  â”‚
â”‚  ë§¤ì¶œì€ 221ì–µ ë‹¬ëŸ¬ë¡œ, ì „ë¶„ê¸° ëŒ€ë¹„ 22% ì¦ê°€í–ˆìœ¼ë©°,        â”‚
â”‚  ì „ë…„ ë™ê¸° ëŒ€ë¹„ 265% ì¦ê°€í–ˆë‹¤. GAAP ê¸°ì¤€ í¬ì„ ì£¼ë‹¹       â”‚
â”‚  ìˆœì´ìµì€ 4.93ë‹¬ëŸ¬ë¥¼ ê¸°ë¡í–ˆë‹¤.                          â”‚
â”‚  """                                                    â”‚
â”‚                                                         â”‚
â”‚  User: "NVIDIA 4ë¶„ê¸° ë§¤ì¶œì˜ ì „ë…„ ë™ê¸° ëŒ€ë¹„ ì¦ê°€ìœ¨ì€?"    â”‚
â”‚                                                         â”‚
â”‚  Assistant: "265% ì¦ê°€í–ˆìŠµë‹ˆë‹¤."                        â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Two-Stageê°€ íš¨ê³¼ì ì¸ ì´ìœ 

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Ablation Study ê²°ê³¼                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  ë°©ë²•                              â”‚ í‰ê·  ì ìˆ˜          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚
â”‚  Stage 2ë§Œ ì ìš© (Stage 1 ê±´ë„ˆëœ€)  â”‚  52.18              â”‚
â”‚  Stage 1 + Stage 2 (ì „ì²´)         â”‚  54.08              â”‚
â”‚                                                         â”‚
â”‚  â†’ Stage 1ì´ ì—†ìœ¼ë©´ 1.9ì  í•˜ë½!                         â”‚
â”‚  â†’ "ê¸°ë³¸ê¸°ë¥¼ ë¨¼ì € ìµíŒ í›„ ì‹¬í™” í•™ìŠµ"ì´ íš¨ê³¼ì             â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ í•µì‹¬ ê¸°ìˆ  2: Multi-turn Query Retriever

### ë¬¸ì œ: ëŒ€í™”í˜• ê²€ìƒ‰ì˜ ì–´ë ¤ì›€

```
ëŒ€í™” íë¦„:

Q1: "í…ŒìŠ¬ë¼ì˜ ìµœê·¼ ì‹¤ì ì€ ì–´ë•Œ?"
A1: "2024ë…„ 1ë¶„ê¸° ë§¤ì¶œì€ 213ì–µ ë‹¬ëŸ¬ì…ë‹ˆë‹¤."

Q2: "ê²½ìŸì‚¬ì™€ ë¹„êµí•˜ë©´?"  â† ì´ ì§ˆë¬¸ë§Œìœ¼ë¡œ ê²€ìƒ‰ ê°€ëŠ¥?
    â”‚
    â”œâ”€â”€ "ê²½ìŸì‚¬" = ëˆ„êµ¬? (ì´ì „ ë§¥ë½: í…ŒìŠ¬ë¼ì˜ ê²½ìŸì‚¬)
    â””â”€â”€ "ë¹„êµí•˜ë©´" = ë¬´ì—‡ì„? (ì´ì „ ë§¥ë½: ì‹¤ì /ë§¤ì¶œ)
```

### ê¸°ì¡´ í•´ê²°ì±…: Query Rewriting

ê¸°ì¡´ì—ëŠ” LLMì„ ì‚¬ìš©í•´ ì§ˆë¬¸ì„ ë‹¤ì‹œ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Query Rewriting ë°©ì‹                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  ì›ë˜ ì§ˆë¬¸: "ê²½ìŸì‚¬ì™€ ë¹„êµí•˜ë©´?"                         â”‚
â”‚                    â”‚                                    â”‚
â”‚                    â–¼                                    â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚         â”‚   GPT-3.5-Turbo  â”‚  â† ì¶”ê°€ API í˜¸ì¶œ í•„ìš”!    â”‚
â”‚         â”‚  Query Rewriter  â”‚  â† ì¶”ê°€ ë¹„ìš© ë°œìƒ!        â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                  â”‚                                      â”‚
â”‚                  â–¼                                      â”‚
â”‚  ì¬ì‘ì„±ëœ ì§ˆë¬¸: "í…ŒìŠ¬ë¼ 2024ë…„ 1ë¶„ê¸° ë§¤ì¶œê³¼              â”‚
â”‚                 ê²½ìŸì‚¬(ë¦¬ë¹„ì•ˆ, ë£¨ì‹œë“œ ë“±) ë¹„êµ"          â”‚
â”‚                    â”‚                                    â”‚
â”‚                    â–¼                                    â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚         â”‚    Retriever     â”‚                           â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ë¬¸ì œì :
- ì¶”ê°€ LLM í˜¸ì¶œ â†’ ë¹„ìš© ì¦ê°€, ì§€ì—°ì‹œê°„ ì¦ê°€
- GPT API ì˜ì¡´ì„± â†’ í”„ë¼ì´ë²„ì‹œ ìš°ë ¤
```

### ChatQAì˜ í•´ê²°ì±…: Fine-tuned Dense Retriever

ChatQAëŠ” **Query Rewriting ì—†ì´** ì§ì ‘ ëŒ€í™” ë§¥ë½ì„ ì´í•´í•˜ëŠ” Retrieverë¥¼ í›ˆë ¨ì‹œì¼°ìŠµë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ChatQA Dense Retriever ë°©ì‹                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  ëŒ€í™” íˆìŠ¤í† ë¦¬ + í˜„ì¬ ì§ˆë¬¸:                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Q1: "í…ŒìŠ¬ë¼ì˜ ìµœê·¼ ì‹¤ì ì€ ì–´ë•Œ?"                 â”‚   â”‚
â”‚  â”‚ A1: "2024ë…„ 1ë¶„ê¸° ë§¤ì¶œì€ 213ì–µ ë‹¬ëŸ¬ì…ë‹ˆë‹¤."      â”‚   â”‚
â”‚  â”‚ Q2: "ê²½ìŸì‚¬ì™€ ë¹„êµí•˜ë©´?"                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                        â”‚                                â”‚
â”‚                        â–¼                                â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚         â”‚  Dragon Multi-turn       â”‚                   â”‚
â”‚         â”‚  Query Retriever         â”‚ â† í•œ ë²ˆì— ì²˜ë¦¬!   â”‚
â”‚         â”‚  (Fine-tuned on ConvQA)  â”‚                   â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                        â”‚                                â”‚
â”‚                        â–¼                                â”‚
â”‚              ê´€ë ¨ ë¬¸ì„œ ê²€ìƒ‰ ì™„ë£Œ                         â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì¥ì :
- Query Rewriting ë¶ˆí•„ìš” â†’ ë¹„ìš© ì ˆê°
- ë‹¨ì¼ ëª¨ë¸ë¡œ ì²˜ë¦¬ â†’ ì§€ì—°ì‹œê°„ ê°ì†Œ
- ì˜¤í”ˆì†ŒìŠ¤ë¡œ ë°°í¬ ê°€ëŠ¥ â†’ í”„ë¼ì´ë²„ì‹œ ë³´ì¥
```

### Retriever ì„±ëŠ¥ ë¹„êµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Retrieval ì„±ëŠ¥ ë¹„êµ (Top-1 Recall)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  ë°©ë²•                          â”‚ Doc2Dial â”‚ QuAC â”‚ ... â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”‚     â”‚
â”‚  Dragon (Single-turn)         â”‚   37.4   â”‚ 35.1 â”‚     â”‚
â”‚  + GPT-3.5 Query Rewriting    â”‚   44.2   â”‚ 42.3 â”‚     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”‚     â”‚
â”‚  Dragon-Multiturn (ChatQA)    â”‚   44.0   â”‚ 42.1 â”‚     â”‚
â”‚                                                         â”‚
â”‚  â†’ Query Rewritingê³¼ ê±°ì˜ ë™ë“±í•œ ì„±ëŠ¥!                   â”‚
â”‚  â†’ But, GPT API ë¹„ìš© ì—†ì´!                              â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš« Hallucination ë°©ì§€: Unanswerable ì²˜ë¦¬

RAG ì‹œìŠ¤í…œì˜ ê³ ì§ˆì ì¸ ë¬¸ì œ ì¤‘ í•˜ë‚˜ëŠ” **ë‹µì„ ëª¨ë¥¼ ë•Œë„ ê·¸ëŸ´ë“¯í•˜ê²Œ ë‹µë³€ì„ ì§€ì–´ë‚´ëŠ” ê²ƒ**ì…ë‹ˆë‹¤.

### ChatQAì˜ í•´ê²°ì±…

í›ˆë ¨ ë°ì´í„°ì— **"ë‹µë³€ ë¶ˆê°€ëŠ¥" ìƒ˜í”Œ**ì„ ì†ŒëŸ‰ ì¶”ê°€í•©ë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             Unanswerable ìƒ˜í”Œ ì˜ˆì‹œ                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  Context: """                                           â”‚
â”‚  ì• í”Œì€ 2024ë…„ 1ì›” ì•„ì´í° 15 ì‹œë¦¬ì¦ˆì˜ íŒë§¤ ì‹¤ì ì„        â”‚
â”‚  ë°œí‘œí–ˆë‹¤. ì•„ì´í° 15 Pro Maxê°€ ê°€ì¥ ì¸ê¸° ìˆëŠ”            â”‚
â”‚  ëª¨ë¸ì´ì—ˆë‹¤.                                            â”‚
â”‚  """                                                    â”‚
â”‚                                                         â”‚
â”‚  User: "ì•„ì´í° 16ì˜ ì¶œì‹œì¼ì€ ì–¸ì œì¸ê°€ìš”?"                â”‚
â”‚                                                         â”‚
â”‚  Assistant: "ì£¼ì–´ì§„ ë¬¸ì„œì—ì„œ ì•„ì´í° 16ì— ëŒ€í•œ            â”‚
â”‚              ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."                   â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Unanswerable ì²˜ë¦¬ ì„±ëŠ¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Unanswerable ì‹œë‚˜ë¦¬ì˜¤ F1 Score                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  ëª¨ë¸                    â”‚ F1 Score                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”‚
â”‚  GPT-3.5-Turbo          â”‚  64.0                        â”‚
â”‚  ChatQA-70B             â”‚  75.0                        â”‚
â”‚  GPT-4                  â”‚  78.5                        â”‚
â”‚                                                         â”‚
â”‚  â†’ ChatQAê°€ GPT-3.5ë¥¼ í¬ê²Œ ì•ì„¬                         â”‚
â”‚  â†’ GPT-4ì™€ì˜ ê²©ì°¨ë„ 3.5%ì— ë¶ˆê³¼                         â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š ChatRAG Bench: ì¢…í•© ë²¤ì¹˜ë§ˆí¬

ChatQA ì—°êµ¬íŒ€ì€ **10ê°œ ë°ì´í„°ì…‹**ìœ¼ë¡œ êµ¬ì„±ëœ ì¢…í•© ë²¤ì¹˜ë§ˆí¬ë¥¼ í•¨ê»˜ ê³µê°œí–ˆìŠµë‹ˆë‹¤.

### ChatRAG Bench êµ¬ì„±

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ChatRAG Bench ë°ì´í„°ì…‹                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  ğŸ“„ ì¥ë¬¸ì„œ + Retrieval í•„ìš” (5ê°œ)                       â”‚
â”‚     - Doc2Dial: ë¬¸ì„œ ê¸°ë°˜ ëŒ€í™”                          â”‚
â”‚     - QuAC: Wikipedia ê¸°ë°˜ QA                           â”‚
â”‚     - QReCC: Query Rewriting í•„ìš”                       â”‚
â”‚     - TopiOCQA: í† í”½ ì „í™˜ í¬í•¨                          â”‚
â”‚     - INSCIT: ì •ë³´ íƒìƒ‰ ëŒ€í™”                            â”‚
â”‚                                                         â”‚
â”‚  ğŸ“Š í…Œì´ë¸” + ìˆ˜í•™ ê³„ì‚° (3ê°œ)                            â”‚
â”‚     - ConvFinQA: ê¸ˆìœµ í…Œì´ë¸” ê³„ì‚°                       â”‚
â”‚     - SQA: ìˆœì°¨ì  í…Œì´ë¸” QA                             â”‚
â”‚     - HybriDialogue: í•˜ì´ë¸Œë¦¬ë“œ ë°ì´í„°                  â”‚
â”‚                                                         â”‚
â”‚  ğŸ“ ì¼ë°˜ ëŒ€í™”í˜• QA (2ê°œ)                                â”‚
â”‚     - CoQA: Conversational QA                           â”‚
â”‚     - DoQA: ë„ë©”ì¸ íŠ¹í™” QA                              â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ ì‹¤í—˜ ê²°ê³¼

### ì£¼ìš” ëª¨ë¸ ì„±ëŠ¥ ë¹„êµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            ChatRAG Bench í‰ê·  ì ìˆ˜ ë¹„êµ                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  ëª¨ë¸                        â”‚ í‰ê·  ì ìˆ˜                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”‚
â”‚  Llama2-70B-SFT             â”‚  43.22                   â”‚
â”‚  Llama2-70B-Chat            â”‚  45.21                   â”‚
â”‚  GPT-3.5-Turbo              â”‚  50.37                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”‚
â”‚  GPT-4-0613                 â”‚  53.90                   â”‚
â”‚  GPT-4-Turbo-2024-04-09     â”‚  54.03                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”‚
â”‚  ChatQA-1.0-70B (Llama2)    â”‚  54.14  âœ¨               â”‚
â”‚  ChatQA-1.5-70B (Llama3)    â”‚  56.47  âœ¨âœ¨              â”‚
â”‚                                                         â”‚
â”‚  ğŸ‰ ChatQAê°€ GPT-4ë¥¼ ëŠ¥ê°€!                              â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ê°œì„  íš¨ê³¼ ì‹œê°í™”

```
ê¸°ì¤€: Llama2-70B-SFT â†’ ChatQA-70B

ê°œì„ í­:
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ConvFinQA   â•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  +27.05    â•‘
â•‘  DoQA        â•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ      +23.73    â•‘
â•‘  QuAC        â•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ              +16.17    â•‘
â•‘  QReCC       â•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                        +6.17     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â†’ í…Œì´ë¸”/ê³„ì‚° ëŠ¥ë ¥(ConvFinQA)ì—ì„œ íŠ¹íˆ í° ê°œì„ !
```

### Human Evaluation ê²°ê³¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Human Evaluation (1,800 ìƒ˜í”Œ)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  ChatQA-70B vs GPT-4 ë¹„êµ:                              â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚                                           â”‚         â”‚
â”‚  â”‚  ChatQA ìŠ¹ë¦¬:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  ~45%         â”‚         â”‚
â”‚  â”‚  ë¬´ìŠ¹ë¶€:       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ      ~35%         â”‚         â”‚
â”‚  â”‚  GPT-4 ìŠ¹ë¦¬:   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  ~45%         â”‚         â”‚
â”‚  â”‚                                           â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                         â”‚
â”‚  â†’ ì‹¤ì œ ì‚¬ìš©ì í‰ê°€ì—ì„œë„ GPT-4ì™€ ëŒ€ë“±!                  â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ í•µì‹¬ ì¸ì‚¬ì´íŠ¸ ì •ë¦¬

### 1. ë‹¨ê³„ì  í•™ìŠµì˜ ì¤‘ìš”ì„±

```
"ëª¨ë“  ê²ƒì„ í•œ ë²ˆì— ê°€ë¥´ì¹˜ì§€ ë§ê³ , 
 ê¸°ë³¸ê¸°(Stage 1) â†’ ì‹¬í™”(Stage 2) ìˆœì„œë¡œ!"

ì´ê²ƒì´ ChatQA two-stage tuningì˜ í•µì‹¬ ì² í•™ì…ë‹ˆë‹¤.
```

### 2. ë°ì´í„° í’ˆì§ˆ > í•©ì„± ë°ì´í„° ì˜ì¡´

```
"OpenAI GPTë¡œ ë§Œë“  í•©ì„± ë°ì´í„° ì—†ì´ë„ 
 GPT-4ë¥¼ ë„˜ì–´ì„¤ ìˆ˜ ìˆë‹¤"

HumanAnnotatedConvQA ë°ì´í„°ì…‹ êµ¬ì¶•ì´ í•µì‹¬ ê¸°ì—¬ì…ë‹ˆë‹¤.
```

### 3. ë¹„ìš© íš¨ìœ¨ì ì¸ Retrieval

```
"Query Rewritingì— LLM ì“°ì§€ ë§ˆì„¸ìš”.
 Fine-tuned Dense Retrieverë¡œ ì¶©ë¶„í•©ë‹ˆë‹¤."

ë°°í¬ ë¹„ìš©ì„ í¬ê²Œ ì ˆê°í•˜ë©´ì„œ ë™ë“±í•œ ì„±ëŠ¥!
```

### 4. Hallucination ë°©ì§€

```
"ì†ŒëŸ‰ì˜ 'cannot answer' ìƒ˜í”Œë§Œìœ¼ë¡œ
 hallucinationì„ í¬ê²Œ ì¤„ì¼ ìˆ˜ ìˆë‹¤"

ì‹¤ìš©ì ì´ê³  ê°„ë‹¨í•œ í•´ê²°ì±…ì…ë‹ˆë‹¤.
```

---

## ğŸš€ ì‹¤ì œ í™œìš©í•˜ê¸°

### ëª¨ë¸ ì‚¬ìš© ì˜ˆì‹œ

```python
from transformers import AutoTokenizer, AutoModelForCausalLM
import torch

model_id = "nvidia/Llama3-ChatQA-1.5-70B"
tokenizer = AutoTokenizer.from_pretrained(model_id)
model = AutoModelForCausalLM.from_pretrained(
    model_id, 
    torch_dtype=torch.float16, 
    device_map="auto"
)

# ë¬¸ì„œì™€ ì§ˆë¬¸ ì¤€ë¹„
document = """
NVIDIAëŠ” 2024ë…„ 1ì›” 28ì¼ ë§ˆê°ëœ 4ë¶„ê¸° ì‹¤ì ì„ ë°œí‘œí–ˆë‹¤.
ë§¤ì¶œì€ 221ì–µ ë‹¬ëŸ¬ë¡œ, ì „ë¶„ê¸° ëŒ€ë¹„ 22% ì¦ê°€í–ˆìœ¼ë©°,
ì „ë…„ ë™ê¸° ëŒ€ë¹„ 265% ì¦ê°€í–ˆë‹¤.
"""

messages = [
    {
        "role": "user", 
        "content": "4ë¶„ê¸° ë§¤ì¶œì˜ ì „ë…„ ë™ê¸° ëŒ€ë¹„ ì¦ê°€ìœ¨ì€?"
    }
]

# ChatQA í”„ë¡¬í”„íŠ¸ í˜•ì‹ì— ë§ê²Œ êµ¬ì„±
prompt = f"System: ì£¼ì–´ì§„ ë¬¸ì„œë¥¼ ë°”íƒ•ìœ¼ë¡œ ë‹µë³€í•˜ì„¸ìš”.\n\n"
prompt += f"Document: {document}\n\n"
prompt += f"User: {messages[0]['content']}\n\nAssistant:"

# ìƒì„±
inputs = tokenizer(prompt, return_tensors="pt").to(model.device)
outputs = model.generate(**inputs, max_new_tokens=100)
response = tokenizer.decode(outputs[0], skip_special_tokens=True)
```

### í™œìš© ì‹œë‚˜ë¦¬ì˜¤

| ì‹œë‚˜ë¦¬ì˜¤ | ChatQA ì í•©ì„± | ì´ìœ  |
|---------|--------------|------|
| ê¸°ì—… ë¬¸ì„œ QA ì±—ë´‡ | â­â­â­â­â­ | í”„ë¼ì´ë²„ì‹œ ë³´ì¥, ë¹„ìš© ì ˆê° |
| ê³ ê° ì§€ì› ì‹œìŠ¤í…œ | â­â­â­â­â­ | ëŒ€í™” ë§¥ë½ ì´í•´ ìš°ìˆ˜ |
| ê¸ˆìœµ ë³´ê³ ì„œ ë¶„ì„ | â­â­â­â­â­ | í…Œì´ë¸”/ê³„ì‚° ëŠ¥ë ¥ ê°•í™” |
| ë²•ë¥  ë¬¸ì„œ ê²€í†  | â­â­â­â­ | "ë‹µë³€ ë¶ˆê°€" ì²˜ë¦¬ ì¤‘ìš” |

---

## ğŸ“š ê³µê°œ ìë£Œ

NVIDIAëŠ” ì—°êµ¬ ì»¤ë®¤ë‹ˆí‹°ë¥¼ ìœ„í•´ ë‹¤ìŒì„ ëª¨ë‘ ê³µê°œí–ˆìŠµë‹ˆë‹¤:

- **ëª¨ë¸ ê°€ì¤‘ì¹˜**: [Hugging Face](https://huggingface.co/nvidia/Llama3-ChatQA-1.5-70B)
- **ChatRAG Bench**: [ë²¤ì¹˜ë§ˆí¬ ë°ì´í„°ì…‹](https://huggingface.co/datasets/nvidia/ChatRAG-Bench)
- **í•™ìŠµ ë°ì´í„°**: SFT ë° ConvQA ë°ì´í„°ì…‹
- **Dragon Retriever**: Multi-turn query retriever

---

## ğŸ”® ì‹œì‚¬ì  ë° í–¥í›„ ì „ë§

### ì˜¤í”ˆì†ŒìŠ¤ LLMì˜ ê°€ëŠ¥ì„±

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ChatQAê°€ ë³´ì—¬ì¤€ ê°€ëŠ¥ì„±                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  "ì•½í•œ ë² ì´ìŠ¤ ëª¨ë¸(Llama2)ë¡œë„                           â”‚
â”‚   ì˜¬ë°”ë¥¸ ë°©ë²•ë¡ ì„ ì ìš©í•˜ë©´                               â”‚
â”‚   ìµœê°•ì˜ ìƒìš© ëª¨ë¸(GPT-4)ì„ ë„˜ì–´ì„¤ ìˆ˜ ìˆë‹¤"              â”‚
â”‚                                                         â”‚
â”‚  â†’ ë°ì´í„° íë ˆì´ì…˜ì˜ ì¤‘ìš”ì„±                              â”‚
â”‚  â†’ í•™ìŠµ ë°©ë²•ë¡ ì˜ ì¤‘ìš”ì„±                                 â”‚
â”‚  â†’ Task-specific ìµœì í™”ì˜ ê°€ì¹˜                          â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ê¸°ì—… RAG ì‹œìŠ¤í…œì— ì£¼ëŠ” êµí›ˆ

1. **Two-stage ì ‘ê·¼ë²• ê³ ë ¤**: ë²”ìš© instruction tuning í›„ ë„ë©”ì¸ íŠ¹í™” tuning
2. **Query Rewriting ì¬ê³ **: Fine-tuned retrieverë¡œ ë¹„ìš© ì ˆê° ê°€ëŠ¥
3. **Unanswerable ìƒ˜í”Œ ì¶”ê°€**: Hallucination ë°©ì§€ì— íš¨ê³¼ì 
4. **ë²¤ì¹˜ë§ˆí¬ í™œìš©**: ChatRAG Benchë¡œ ì‹œìŠ¤í…œ í‰ê°€

---

## ğŸ“– ì°¸ê³  ìë£Œ

- **ë…¼ë¬¸**: [ChatQA: Surpassing GPT-4 on Conversational QA and RAG](https://arxiv.org/abs/2401.10225)
- **í”„ë¡œì íŠ¸ í˜ì´ì§€**: [chatqa-project.github.io](https://chatqa-project.github.io/)
- **Hugging Face**: [nvidia/Llama3-ChatQA-1.5-70B](https://huggingface.co/nvidia/Llama3-ChatQA-1.5-70B)

---

*ì´ ê¸€ì´ ë„ì›€ì´ ë˜ì…¨ë‹¤ë©´ ê³µìœ í•´ ì£¼ì„¸ìš”! ğŸ™*
